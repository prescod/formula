<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Formula Compiler Demo</title>
    <script src="http://formulapages.github.io/formulafoundry/dist/formulafoundry.js"></script>
  </head>
  <body>
    <h1>Context Data</h1>
    <textarea id="data" rows="3" cols="80" onkeyup="try{ data=JSON.parse(this.value); runFN(last); window.dataError.textContent = ''; } catch(e) { window.dataError.textContent = e.message; }">
      { "success": true, "message": "Hello, World", "errorMessage": "Something when wrong" }
    </textarea>
    <div id="dataError"></div>
    <h1>Formula</h1>
    <textarea id="formula" rows="3" cols="80" onkeyup="runFN(this.value)">IF( success, message, errorMessage)</textarea>
    <div id="formulaError"></div>
    <h1>Result</h1>
    <div id="result">
    </div>
    <script>
      var data = { "message": "Hello, World" };
      var context = { get: function(k) { return data[k]; }}
      var last;

      function runFN(text) {
        last = text;
        try {
          window.result.textContent = FormulaFoundry.run(text, context);
          window.formulaError.textContent = '';
          last = text;
        } catch(e) {
          window.formulaError.textContent = e.message;
        }
      }

      onload = function() {
        runFN('message');
      }();

    </script>
  </body>
</html>
