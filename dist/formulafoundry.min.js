(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
window&&(window.FormulaFoundry=require("./lib/compiler"));
},{"./lib/compiler":2}],2:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r["default"]=e,r}function compile(e){function r(e){return"'"==e[0]&&"'"===e[e.length-1]?e:"'"+e+"'"}function n(e){return e.map(function(e){return t(e)}).join(", ")}function t(e){var u=void 0,o=void 0;switch(e.type){case"operator":switch(e.subtype){case"prefix-plus":return"+"+t(e.operands[0]);case"prefix-minus":return"-"+t(e.operands[0]);case"infix-add":return p.push("add"),i+"ADD("+t(e.operands[0])+", "+t(e.operands[1])+")";case"infix-subtract":return p.push("subtract"),i+"SUBTRACT("+t(e.operands[0])+", "+t(e.operands[1])+")";case"infix-multiply":return p.push("multiply"),i+"MULTIPLY("+t(e.operands[0])+", "+t(e.operands[1])+")";case"infix-divide":return p.push("divide"),i+"DIVIDE("+t(e.operands[0])+", "+t(e.operands[1])+")";case"infix-power":return p.push("power"),i+"POWER("+t(e.operands[0])+", "+t(e.operands[1])+")";case"infix-concat":return u=t(e.operands[0]),o=t(e.operands[1]),p.push("concatenate"),i+"CONCATENATE("+r(u)+", "+r(o)+")";case"infix-eq":return p.push("eq"),i+"EQ("+t(e.operands[0])+", "+t(e.operands[1])+")";case"infix-ne":return p.push("ne"),i+"NE("+t(e.operands[0])+", "+t(e.operands[1])+")";case"infix-gt":return p.push("gt"),i+"GT("+t(e.operands[0])+", "+t(e.operands[1])+")";case"infix-gte":return p.push("gte"),i+"GTE("+t(e.operands[0])+", "+t(e.operands[1])+")";case"infix-lt":return p.push("lt"),i+"LT("+t(e.operands[0])+", "+t(e.operands[1])+")";case"infix-lte":return p.push("lte"),i+"LTE("+t(e.operands[0])+", "+t(e.operands[1])+")"}throw TypeException("Unknown operator: "+e.subtype);case"group":return"("+t(e.exp)+")";case"function":return p.push(e.name.toUpperCase()),i+e.name.toUpperCase()+"( "+n(e.args)+" )";case"cell":return"undefined"==typeof a||s||a.push(e),'context.get("'+e.addr+'")';case"range":return"undefined"!=typeof a&&(a.push(e),s=!0),u=t(e.topLeft),o=t(e.bottomRight),s=!1,"function"===e.topLeft.type&&(u="function() { return ("+u+"); }"),"function"===e.bottomRight.type&&(o="function() { return ("+o+"); }"),"context.range( "+u+", "+o+" )";case"value":switch(e.subtype){case"array":return"["+n(e.items)+"]";case"string":return"'"+e.value.replace(/'/g,"''")+"'";case"variable":return a&&!s&&a.push(e),'context.get("'+e.value+'")';default:return e.value}}}var u,o=e,s=!1,a=[],p=[],i="this.";"string"==typeof o&&(o=_parser.parser.parse(e));var c=compiledNumber++,d=t(o);return u=new Function("context","// "+e+"\n  return ("+d+");\n  //@ sourceURL=formula_function_"+c+".js'\n  "),u.id=c,u.exp=e,u.ast=o,u.code=d,u.precedents=a,u.requires=p,u}function run(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments[2],t=compile(e),u=n;return"undefined"==typeof n&&(u=t.requires.map(function(e){return e.toUpperCase()}).reduce(function(e,r){return e[r]=FF[r],e},{})),"function"!==r.get&&(r.get=function(e){return r[e]}),t.bind(u)(r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.compile=compile,exports.run=run;var _parser=require("./parser"),_functionfoundry=require("functionfoundry"),FF=_interopRequireWildcard(_functionfoundry),compiledNumber=0;

},{"./parser":3,"functionfoundry":5}],3:[function(require,module,exports){
(function (process){
var parser=function(){function t(){this.yy={}}var e=function(t,e,s,r){for(s=s||{},r=t.length;r--;s[t[r]]=e);return s},s=[1,4],r=[1,5],n=[1,6],i=[1,7],a=[1,8],o=[1,9],h=[1,12],c=[1,13],l=[1,14],y=[1,15],u=[1,16],p=[1,17],f=[1,25],b=[1,19],g=[1,20],m=[1,21],d=[1,22],_=[1,23],k=[1,24],x=[1,26],v=[1,27],E=[1,28],$=[1,29],S=[1,30],A=[1,31],I=[5,6,7,8,9,10,11,12,13,14,15,16,17,19,20,33,34,37],w=[5,6,7,8,12,13,14,15,16,17,19,33,34,37],T=[1,60],L=[1,61],N=[19,33,34,37],z=[5,6,7,8,9,10,12,13,14,15,16,17,19,33,34,37],F=[5,6,12,13,14,15,16,19,33,34,37],P={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,"=":6,"+":7,"-":8,"*":9,"/":10,"^":11,"<>":12,">":13,"<":14,">=":15,"<=":16,"&":17,"(":18,")":19,":":20,CELL:21,SHEET:22,IDENT:23,func:24,array_literal:25,TRUE:26,FALSE:27,STRING:28,NUMBER:29,"%":30,range:31,param_list:32,",":33,";":34,FUNC:35,"{":36,"}":37,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"=",7:"+",8:"-",9:"*",10:"/",11:"^",12:"<>",13:">",14:"<",15:">=",16:"<=",17:"&",18:"(",19:")",20:":",21:"CELL",22:"SHEET",23:"IDENT",26:"TRUE",27:"FALSE",28:"STRING",29:"NUMBER",30:"%",33:",",34:";",35:"FUNC",36:"{",37:"}"},productions_:[0,[3,2],[3,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,3],[4,2],[4,3],[4,3],[4,1],[4,2],[4,1],[4,2],[4,1],[4,1],[4,1],[4,1],[4,1],[4,2],[4,1],[31,3],[32,1],[32,3],[32,3],[24,4],[24,3],[25,3]],performAction:function(t,e,s,r,n,i,a){var o=i.length-1;switch(n){case 1:case 2:return i[o-1];case 3:this.$={type:"operator",subtype:"infix-add",operands:[i[o-2],i[o]]};break;case 4:this.$={type:"operator",subtype:"infix-subtract",operands:[i[o-2],i[o]]};break;case 5:this.$={type:"operator",subtype:"infix-multiply",operands:[i[o-2],i[o]]};break;case 6:this.$={type:"operator",subtype:"infix-divide",operands:[i[o-2],i[o]]};break;case 7:this.$={type:"operator",subtype:"infix-power",operands:[i[o-2],i[o]]};break;case 8:this.$={type:"operator",subtype:"infix-ne",operands:[i[o-2],i[o]]};break;case 9:this.$={type:"operator",subtype:"infix-eq",operands:[i[o-2],i[o]]};break;case 10:this.$={type:"operator",subtype:"infix-gt",operands:[i[o-2],i[o]]};break;case 11:this.$={type:"operator",subtype:"infix-lt",operands:[i[o-2],i[o]]};break;case 12:this.$={type:"operator",subtype:"infix-gte",operands:[i[o-2],i[o]]};break;case 13:this.$={type:"operator",subtype:"infix-lte",operands:[i[o-2],i[o]]};break;case 14:this.$={type:"operator",subtype:"prefix-plus",operands:[i[o]]};break;case 15:this.$={type:"operator",subtype:"infix-concat",operands:[i[o-2],i[o]]};break;case 16:this.$={type:"operator",subtype:"prefix-minus",operands:[i[o]]};break;case 17:this.$={type:"group",exp:i[o-1]};break;case 18:this.$={type:"range",subtype:"local",topLeft:i[o-2],bottomRight:i[o]};break;case 19:this.$={type:"cell",subtype:"local",addr:i[o]};break;case 20:this.$={type:"cell",subtype:"remote",worksheet:i[o-1],addr:i[o]};break;case 21:this.$={type:"value",subtype:"variable",value:i[o]};break;case 22:this.$={type:"cell",subtype:"remote-named",worksheet:i[o-1],addr:i[o]};break;case 23:case 24:this.$=i[o];break;case 25:this.$={type:"value",subtype:"boolean",value:!0};break;case 26:this.$={type:"value",subtype:"boolean",value:!1};break;case 27:this.$={type:"value",subtype:"string",value:String(t)};break;case 28:this.$={type:"value",subtype:"number",value:i[o-1]/100};break;case 29:this.$={type:"value",subtype:"number",value:Number(t)};break;case 31:this.$=[i[o]];break;case 32:this.$=i[o-2].concat([i[o]]);break;case 33:this.$="array"!==i[o][0].subtype?[{type:"value",subtype:"array",items:i[o-2]},{type:"value",subtype:"array",items:i[o]}]:[{type:"value",subtype:"array",items:i[o-2]}].concat(i[o]);break;case 34:this.$={type:"function",name:i[o-3],args:i[o-1]};break;case 35:this.$={type:"function",name:i[o-2],args:[]};break;case 36:this.$={type:"value",subtype:"array",items:i[o-1]}}},table:[{3:1,4:2,6:[1,3],7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{1:[3]},{5:[1,18],6:f,7:b,8:g,9:m,10:d,11:_,12:k,13:x,14:v,15:E,16:$,17:S,20:A},{4:32,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:33,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:34,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:35,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},e(I,[2,19]),{21:[1,36],23:[1,37]},e(I,[2,21]),e(I,[2,23]),e(I,[2,24]),e(I,[2,25]),e(I,[2,26]),e(I,[2,27]),e(I,[2,29],{30:[1,38]}),{18:[1,39]},{4:41,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,32:40,35:u,36:p},{1:[2,1]},{4:42,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:43,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:44,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:45,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:46,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:47,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:48,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:49,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:50,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:51,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:52,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:53,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:54,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{5:[1,55],6:f,7:b,8:g,9:m,10:d,11:_,12:k,13:x,14:v,15:E,16:$,17:S,20:A},e(w,[2,14],{9:m,10:d,11:_,20:A}),e(I,[2,16]),{6:f,7:b,8:g,9:m,10:d,11:_,12:k,13:x,14:v,15:E,16:$,17:S,19:[1,56],20:A},e(I,[2,20]),e(I,[2,22]),e(I,[2,28]),{4:41,7:s,8:r,18:n,19:[1,58],21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,32:57,35:u,36:p},{33:T,34:L,37:[1,59]},e(N,[2,31],{6:f,7:b,8:g,9:m,10:d,11:_,12:k,13:x,14:v,15:E,16:$,17:S,20:A}),e(w,[2,3],{9:m,10:d,11:_,20:A}),e(w,[2,4],{9:m,10:d,11:_,20:A}),e(z,[2,5],{11:_,20:A}),e(z,[2,6],{11:_,20:A}),e([5,6,7,8,9,10,11,12,13,14,15,16,17,19,33,34,37],[2,7],{20:A}),e(F,[2,8],{7:b,8:g,9:m,10:d,11:_,17:S,20:A}),e(F,[2,9],{7:b,8:g,9:m,10:d,11:_,17:S,20:A}),e(F,[2,10],{7:b,8:g,9:m,10:d,11:_,17:S,20:A}),e(F,[2,11],{7:b,8:g,9:m,10:d,11:_,17:S,20:A}),e(F,[2,12],{7:b,8:g,9:m,10:d,11:_,17:S,20:A}),e(F,[2,13],{7:b,8:g,9:m,10:d,11:_,17:S,20:A}),e([5,6,12,13,14,15,16,17,19,33,34,37],[2,15],{7:b,8:g,9:m,10:d,11:_,20:A}),e(I,[2,18]),{1:[2,2]},e(I,[2,17]),{19:[1,62],33:T,34:L},e(I,[2,35]),e(I,[2,36]),{4:63,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,35:u,36:p},{4:41,7:s,8:r,18:n,21:i,22:a,23:o,24:10,25:11,26:h,27:c,28:l,29:y,32:64,35:u,36:p},e(I,[2,34]),e(N,[2,32],{6:f,7:b,8:g,9:m,10:d,11:_,12:k,13:x,14:v,15:E,16:$,17:S,20:A}),e([19,37],[2,33],{33:T,34:L})],defaultActions:{18:[2,1],55:[2,2]},parseError:function(t,e){function s(t,e){this.message=t,this.hash=e}if(!e.recoverable)throw s.prototype=Error,new s(t,e);this.trace(t)},parse:function(t){var e=this,s=[0],r=[null],n=[],i=this.table,a="",o=0,h=0,c=0,l=2,y=1,u=n.slice.call(arguments,1),p=Object.create(this.lexer),f={yy:{}};for(var b in this.yy)Object.prototype.hasOwnProperty.call(this.yy,b)&&(f.yy[b]=this.yy[b]);p.setInput(t,f.yy),f.yy.lexer=p,f.yy.parser=this,"undefined"==typeof p.yylloc&&(p.yylloc={});var g=p.yylloc;n.push(g);var m=p.options&&p.options.ranges;"function"==typeof f.yy.parseError?this.parseError=f.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var d,_,k,x,v,E,$,S,A,I=function(){var t;return t=p.lex()||y,"number"!=typeof t&&(t=e.symbols_[t]||t),t},w={};;){if(k=s[s.length-1],this.defaultActions[k]?x=this.defaultActions[k]:(null!==d&&"undefined"!=typeof d||(d=I()),x=i[k]&&i[k][d]),"undefined"==typeof x||!x.length||!x[0]){var T="";A=[];for(E in i[k])this.terminals_[E]&&E>l&&A.push("'"+this.terminals_[E]+"'");T=p.showPosition?"Parse error on line "+(o+1)+":\n"+p.showPosition()+"\nExpecting "+A.join(", ")+", got '"+(this.terminals_[d]||d)+"'":"Parse error on line "+(o+1)+": Unexpected "+(d==y?"end of input":"'"+(this.terminals_[d]||d)+"'"),this.parseError(T,{text:p.match,token:this.terminals_[d]||d,line:p.yylineno,loc:g,expected:A})}if(x[0]instanceof Array&&x.length>1)throw new Error("Parse Error: multiple actions possible at state: "+k+", token: "+d);switch(x[0]){case 1:s.push(d),r.push(p.yytext),n.push(p.yylloc),s.push(x[1]),d=null,_?(d=_,_=null):(h=p.yyleng,a=p.yytext,o=p.yylineno,g=p.yylloc,c>0&&c--);break;case 2:if($=this.productions_[x[1]][1],w.$=r[r.length-$],w._$={first_line:n[n.length-($||1)].first_line,last_line:n[n.length-1].last_line,first_column:n[n.length-($||1)].first_column,last_column:n[n.length-1].last_column},m&&(w._$.range=[n[n.length-($||1)].range[0],n[n.length-1].range[1]]),v=this.performAction.apply(w,[a,h,o,f.yy,x[1],r,n].concat(u)),"undefined"!=typeof v)return v;$&&(s=s.slice(0,-1*$*2),r=r.slice(0,-1*$),n=n.slice(0,-1*$)),s.push(this.productions_[x[1]][0]),r.push(w.$),n.push(w._$),S=i[s[s.length-2]][s[s.length-1]],s.push(S);break;case 3:return!0}}return!0}},R=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,s=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),s.length-1&&(this.yylineno-=s.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:s?(s.length===r.length?this.yylloc.first_column:0)+r[r.length-s.length].length-s[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var s,r,n;if(this.options.backtrack_lexer&&(n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(n.yylloc.range=this.yylloc.range.slice(0))),r=t[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],s=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),s)return s;if(this._backtrack){for(var i in n)this[i]=n[i];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,s,r;this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),i=0;i<n.length;i++)if(s=this._input.match(this.rules[n[i]]),s&&(!e||s[0].length>e[0].length)){if(e=s,r=i,this.options.backtrack_lexer){if(t=this.test_match(s,n[i]),t!==!1)return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?(t=this.test_match(e,n[r]),t!==!1?t:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){var t=this.conditionStack.length-1;return t>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return t=this.conditionStack.length-1-Math.abs(t||0),t>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,s,r){switch(s){case 0:break;case 1:return 29;case 2:return 26;case 3:return 27;case 4:return 26;case 5:return 27;case 6:return 26;case 7:return 27;case 8:return 9;case 9:return 10;case 10:return 8;case 11:return 7;case 12:return 17;case 13:return 11;case 14:return 18;case 15:return 19;case 16:return">=";case 17:return"<=";case 18:return"<>";case 19:return"=";case 20:return">";case 21:return"<";case 22:return"{";case 23:return"}";case 24:return"!";case 25:return",";case 26:return":";case 27:return";";case 28:return"%";case 29:return 35;case 30:return 35;case 31:return e.yytext=e.yytext.substr(2,e.yyleng-3).replace(/\"\"/g,'"'),"SHEET";case 32:return e.yytext=e.yytext.substr(1,e.yyleng-3).replace(/\"\"/g,'"'),"SHEET";case 33:return e.yytext=e.yytext.slice(0,-1),"SHEET";case 34:return e.yytext=e.yytext.slice(1,-1),"SHEET";case 35:return"CELL";case 36:return e.yytext=e.yytext.substr(1,e.yyleng-2).replace(/\"\"/g,'"'),"STRING";case 37:return 23;case 38:return 5;case 39:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+(\.[0-9]+)?\b)/,/^(?:TRUE\b)/,/^(?:FALSE\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:True\b)/,/^(?:False\b)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:&)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>=)/,/^(?:<=)/,/^(?:<>)/,/^(?:=)/,/^(?:>)/,/^(?:<)/,/^(?:\{)/,/^(?:\})/,/^(?:!)/,/^(?:,)/,/^(?::)/,/^(?:;)/,/^(?:%)/,/^(?:[A-Za-z](?=[(]))/,/^(?:[A-Za-z][A-Za-z0-9\.]+(?=[(]))/,/^(?:\$'(?:''|[^'])*'!)/,/^(?:'(?:''|[^'])*'!)/,/^(?:[a-zA-Z]([a-zA-Z0-9.$]+)?!)/,/^(?:\$([a-zA-Z])([a-zA-Z0-9.$]+)?!)/,/^(?:\$?([a-zA-Z]+)\$?([0-9]+))/,/^(?:"(?:""|[^"])*")/,/^(?:[a-zA-Z]([a-zA-Z0-9.$^\(]+)?)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39],inclusive:!0}}};return t}();return P.lexer=R,t.prototype=P,P.Parser=t,new t}();"undefined"!=typeof require&&"undefined"!=typeof exports&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),process.exit(1));var e=require("fs").readFileSync(require("path").normalize(t[1]),"utf8");return exports.parser.parse(e)},"undefined"!=typeof module&&require.main===module&&exports.main(process.argv.slice(1)));

}).call(this,require('_process'))
},{"_process":7,"fs":4,"path":6}],4:[function(require,module,exports){

},{}],5:[function(require,module,exports){
"use strict";function ISNUMBER(r){return"number"==typeof r&&!isNaN(r)&&isFinite(r)}function FFError(r){this.name="NotImplementedError",this.message=r||""}function ABS(r){return ISNUMBER(r)?Math.abs(r):error$2.value}function ACOS(r){return ISNUMBER(r)?Math.acos(r):error$2.value}function ADD(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return ISNUMBER(n)&&ISNUMBER(o)?n+o:error$2.value}function AND(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return e.reduce(function(r,e){return e!==!0&&e!==!1&&1!==e&&0!==e?error$2.value:r===error$2.value?error$2.value:r===!1?!1:e===!0||1===e})}function FLATTEN(r){return r.reduce(function(r,e){return r.concat(e)},[])}function SUM(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return FLATTEN(FLATTEN(e)).reduce(function(r,e){return"number"!=typeof e?error$2.value:r+e})}function ISERR(r){return r!==error$2.na&&"Error"===r.constructor.name||"number"==typeof r&&(Number.isNaN(r)||!Number.isFinite(r))}function ISERROR(r){return ISERR(r)||r===error$2.na}function AVERAGE(){var r=SUM.apply(void 0,arguments);return ISERROR(r)?r:r/arguments.length}function BIN2DEC(r){var e;if("string"==typeof r)e=r;else{if("undefined"==typeof r)return error$2.NA;e=r.toString()}return e.length>10?error$2.NUM:10===e.length&&"1"===e[0]?parseInt(e.substring(1),2)-512:parseInt(e,2)}function CELLINDEX(r,e){return Math.floor(r*MaxCols+e)}function UNIQUE(r){return r.reduce(function(r,e){return r.indexOf(e)<0&&r.push(e),r},[])}function CHANGED(r,e){var t=Object.keys(r),n=Object.keys(e);return UNIQUE(t.filter(function(t){return r[t]!==e[t]}).concat(n.filter(function(t){return r[t]!==e[t]})))}function CHOOSE(r){return r&&arguments.length-1!==0?1>r||r>254?error$2.value:arguments.length-1<r?error$2.value:arguments.length<=r-1+1?void 0:arguments[r-1+1]:error$2.na}function ISBLANK(r){return"undefined"==typeof r||null===r}function SELECT(r,e){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&r?("string"==typeof r&&(r=r.split(/ *, */)),Array.isArray(e)?e.map(function(e){return r.reduce(function(r,t){return r[t]=e[t],r},{})}):r.reduce(function(r,t){return r[t]=e[t],r},{})):void 0}function CLEAN(r){var e=Object.keys(r).filter(function(e){return!ISBLANK(r[e])});return SELECT(e,r)}function CODE(){var r=arguments.length<=0||void 0===arguments[0]?"":arguments[0],e=arguments.length<=1||void 0===arguments[1]?1:arguments[1];return 1>e?error$2.na:r.length<e?error$2.value:r.charCodeAt(e-1)}function ISTEXT(r){return"string"==typeof r}function ISREF(r){return r?r.isRef===!0:!1}function COLUMNNUMBER(r){if(!ISTEXT(r))return error$2.value;var e,t=0;if(r.length>0){t=r.charCodeAt(0)-"A".charCodeAt(0);for(var n=1;n<r.length;n++)t+=1,t*=26,t+=r.charCodeAt(n)-"A".charCodeAt(0),e=!0;return t}return error$2.value}function COLUMN(r){return ISREF(r)?COLUMNNUMBER(r.column)+1:error$2.value}function COLUMNLETTER(r){if(!ISNUMBER(r))return error$2.value;var e,t="",n=!1,o=Math.abs(r);do e=o%26,n&&e--,t=String.fromCharCode(e+"A".charCodeAt(0))+t,o=Math.floor((o-e)/26),n=!0;while(o>0);return t}function CONCATENATE(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return e.reduce(function(r,e){return""+r+e})}function COND(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];var n=!1;return e.reduce(function(r,t,o){if(n===!0)return r;if(o===e.length-1){if(o%2===1)return;return t}return o%2===0&&t===!0?(n=!0,e[o+1]):r},void 0)}function ISARRAY(r){return"[object Array]"===Object.prototype.toString.call(r)}function EQ(r,e){return"string"==typeof r&&"string"==typeof e?r.toLowerCase()===e.toLowerCase():r===e}function IN(r,e){return ISBLANK(r)&&ISBLANK(e)?error$2.na:ISARRAY(e)?e.some(function(e){return EQ(e,r)}):error$2.na}function COS(r){return ISNUMBER(r)?Math.cos(r):error$2.value}function ISDATE(r){return r&&"[object Date]"==Object.prototype.toString.call(r)}function SERIAL(r){if(!ISDATE(r))return error$2.na;var e=Math.ceil((r-d1900)/MilliSecondsInDay);return e+(e>59?2:1)}function DATE(r,e,t){return SERIAL(new Date(r,e-1,t))}function PARSEDATE(r){function e(r){var e,t,n,o,a;return e=r+68569,t=Math.floor(4*e/146097),e-=Math.floor((146097*t+3)/4),n=Math.floor(4e3*(e+1)/1461001),e=e-Math.floor(1461*n/4)+31,o=Math.floor(80*e/2447),a=e-Math.floor(2447*o/80),e=Math.floor(o/11),o=o+2-12*e,n=100*(t-49)+n+e,new Date(n,o-1,a)}if(r instanceof Error)return r;if("number"==typeof r)return e(Math.floor(r+JulianOffset));if("string"==typeof r){var t=Date.parse(r);return isNaN(t)?error$2.value:new Date(t)}return error$2.value}function DATEVALUE(r){return SERIAL(PARSEDATE(r))}function DATEDIF(r,e,t){var n=1e3,o=60*n,a=60*o,u=24*a,s=7*u;r=PARSEDATE(r),e=PARSEDATE(e);var i=e-r;if(isNaN(i))return NaN;switch(t){case"Y":return e.getFullYear()-r.getFullYear();case"M":return 12*e.getFullYear()+e.getMonth()-(12*r.getFullYear()+r.getMonth());case"W":return Math.floor(i/s);case"D":return Math.floor(i/u);case"MD":return e.getDate()-r.getDate();case"YM":return e.getMonth()-r.getMonth();case"YD":return new Error("NOT IMPLEMENTED");default:return}}function PARSEBOOL(r){if(r instanceof Error)return r;if("boolean"==typeof r)return r;if("number"==typeof r)return 0!==r;if("string"==typeof r){var e=r.toUpperCase();if("TRUE"===e||"FALSE"===e)return"TRUE"===e}return error$2.value}function DAYS360(r,e,t){if(t=PARSEBOOL(t),r=PARSEDATE(r),e=PARSEDATE(e),r instanceof Error)return r;if(e instanceof Error)return e;if(t instanceof Error)return t;var n,o,a=r.getMonth(),u=e.getMonth();if(t)n=31===r.getDate()?30:r.getDate(),o=31===e.getDate()?30:e.getDate();else{var s=new Date(r.getFullYear(),a+1,0).getDate(),i=new Date(e.getFullYear(),u+1,0).getDate();n=r.getDate()===s?30:r.getDate(),e.getDate()===i?30>n?(u++,o=1):o=30:o=e.getDate()}return 360*(e.getFullYear()-r.getFullYear())+30*(u-a)+(o-n)}function REPT(r,e){for(var t="",n=0;e>n;n++)t+=r;return t}function DEC2BIN(r,e){if(r instanceof Error)return t;var t=parseInt(r);if(Number.isNaN(t))return error$2.value;if(!/^-?[0-9]{1,3}$/.test(t)||-512>t||t>511)return error$2.num;if(0>t)return"1"+REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var n=parseInt(t,10).toString(2);return"undefined"==typeof e?n:isNaN(e)?error$2.value:0>e?error$2.num:(e=Math.floor(e),e>=n.length?REPT("0",e-n.length)+n:error$2.num)}function DIFF(r,e){var t=Object.keys(r),n=Object.keys(e),o=n.filter(function(r){return t.indexOf(r)>-1}),a=n.filter(function(r){return-1===t.indexOf(r)}),u=t.filter(function(r){return-1===n.indexOf(r)}),s=o.filter(function(t){return r[t]!==e[t]});return{unique_left:a,unique_right:u,diff:s.reduce(function(t,n){var o={};return o[n]={left:r[n],right:e[n]},Object.assign({},t,o)},{})}}function DIVIDE(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return 0===o?error$2.div0:ISNUMBER(n)&&ISNUMBER(o)?n/o:error$2.value}function FILTER(r){function e(){return function(r,e){return n.reduce(function(r,t){return r===!1?!1:t[e]},!0)}}for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;t>o;o++)n[o-1]=arguments[o];return r.filter(e())}function FIND(r){var e=arguments.length<=1||void 0===arguments[1]?"":arguments[1],t=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return t=e.indexOf(r,t-1),-1===t?error$2.value:t+1}function GT(r,e){return ISREF(r)&&ISREF(e)?error$2.na:ISARRAY(r)&&ISARRAY(e)?error$2.na:ISREF(r)||ISARRAY(r)?r.map(function(r){return r>e}):ISREF(e)||ISARRAY(e)?e.map(function(e){return e>r}):r>e}function GTE(r,e){return ISREF(r)&&ISREF(e)?error.na:ISARRAY(r)&&ISARRAY(e)?error.na:ISREF(r)||ISARRAY(r)?r.map(function(r){return r>=e}):ISREF(e)||ISARRAY(e)?e.map(function(e){return e>=r}):r>=e}function GUID(){var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=16*Math.random()|0,t="x"==r?e:3&e|8;return t.toString(16)});return r}function HLOOKUP(r,e){var t=arguments.length<=2||void 0===arguments[2]?1:arguments[2],n=arguments[3];if("undefined"==typeof r||ISBLANK(r))return null;if(t>e.length)return error$2.ref;for(var o=(r+"").toLowerCase(),a=e[0],u=0;u<a.length;u++)if(n&&a[u]===r||a[u]==r||"string"==typeof a[u]&&-1!=a[u].toLowerCase().indexOf(o))return e[t-1][u];return error$2.na}function IF(r,e,t){return r||"string"==typeof r&&"true"===r.toLowerCase()?e:t}function IFBLANK(r,e){return ISBLANK(r)?e:r}function ISEMPTY(r){return ISBLANK(r)||ISARRAY(r)&&0===r.length||ISTEXT(r)&&""===r}function IFEMPTY(r,e){return ISEMPTY(r)?e:r}function IFERROR(r){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];return ISERROR(r)?e:r}function IFNA(r,e){return r===error$2.na?e:r}function INDEX2ROW(r){return Math.floor(r/MaxCols)}function INDEX2COL(r){return r-INDEX2ROW(r)*MaxCols}function ISFUNCTION(r){return r&&"[object Function]"==Object.prototype.toString.call(r)}function REF(r,e){if(!ISNUMBER(r)&&!ISFUNCTION(r))return error$2.value;ISBLANK(e)&&(e=r);var t=function(){return ISFUNCTION(r)?r():r},n=function(){return ISFUNCTION(e)?e():e};return{get isRef(){return!0},get top(){return t()},get bottom(){return n()},get row(){return INDEX2ROW(t())+1},get rowIndex(){return INDEX2ROW(t())},get column(){return COLUMNLETTER(INDEX2COL(t()))},get columnIndex(){return INDEX2COL(t())},get bottomRow(){return INDEX2ROW(n())+1},get bottomRowIndex(){return INDEX2ROW(n())},get bottomColumn(){return COLUMNLETTER(INDEX2COL(n()))},get bottomColumnIndex(){return INDEX2COL(n())},hit:function(r){return 0>r?error$2.na:r>=t()&&r<=n()},get size(){return 1+(n()-t())},get cells(){return Array.apply(t(),Array(1+(n()-t()))).map(function(r,e){return e+t()})},get rows(){return UNIQUE(Array.apply(t(),Array(1+(n()-t()))).map(function(r,e){return INDEX2ROW(e+t())}))}}}function INDIRECT(r){return REF(r)}function ISEMAIL(r){var e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(r)}function ISEVEN(r){return!(1&Math.floor(Math.abs(r)))}function ISNA(r){return r===error$2.na}function ISODD(r){return!!(1&Math.floor(Math.abs(r)))}function ISURL(r){var e=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return e.test(r)}function LEN(r){return 0===arguments.length?error$2.error:"string"==typeof r?r.length:r.length?r.length:error$2.value}function LOOKUP(){var r,e,t,n;if(2===arguments.length){r=arguments[0].valueOf(),e=arguments[1];for(var o=0;o<e.length;o++)if("undefined"!=typeof e[o]&&r===e[o].valueOf())return e[o]}else if(3===arguments.length){r=arguments[0].valueOf(),t=arguments[1],n=arguments[2];for(var o=0;o<t.length;o++)if("undefined"!=typeof t[o]&&r===t[o].valueOf())return n[o]}return error.na}function LOWER(r){return ISTEXT(r)?r.toLowerCase():error$2.value}function LT(r,e){return ISREF(r)&&ISREF(e)?error.na:ISARRAY(r)&&ISARRAY(e)?error.na:ISREF(r)||ISARRAY(r)?r.map(function(r){return e>r}):ISREF(e)||ISARRAY(e)?e.map(function(e){return r>e}):e>r}function LTE(r,e){return ISREF(r)&&ISREF(e)?error.na:ISARRAY(r)&&ISARRAY(e)?error.na:ISREF(r)||ISARRAY(r)?r.map(function(r){return e>=r}):ISREF(e)||ISARRAY(e)?e.map(function(e){return r>=e}):e>=r}function MIN(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return FLATTEN(e).reduce(function(r,e){return ISNUMBER(e)?Math.min(r,e):r},Number.POSITIVE_INFINITY)}function MAX(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return FLATTEN(e).reduce(function(r,e){return ISNUMBER(e)?Math.max(r,e):r},Number.NEGATIVE_INFINITY)}function MULTIPLY(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return ISNUMBER(n)&&ISNUMBER(o)?n*o:error$2.value}function N(r){return ISNUMBER(r)||ISERROR(r)?r:r instanceof Date?SERIAL(r):r===!0?1:0}function NUMBERVALUE(r,e,t){e=e||".",t=t||",";var n=1;return ISEMPTY(r)?error$2.value:ISNUMBER(r)?r:("%"===r[r.length-1]&&(n=100,r=r.substr(0,r.length-1)),Number(r.replace(RegExp("["+t+"]","g"),"").replace(e,"."))/n)}function NE(r,e){return!EQ(r,e)}function NOT(r){return r!==!0&&r!==!1&&1!==r&&0!==r?error$2.value:!r}function OCT2DEC(r){if(!/^[0-7]{1,10}$/.test(r))return error$2.num;var e=parseInt(r,8);return e>=536870912?e-1073741824:e}function OR(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return e.reduce(function(r,e){return r===!0?!0:e===!0||1===e},!1)}function PI(){return τ/2}function PMT(r,e,t){var n=arguments.length<=3||void 0===arguments[3]?0:arguments[3],o=arguments.length<=4||void 0===arguments[4]?0:arguments[4];if(!ISNUMBER(r)||!ISNUMBER(e))return error$2.value;if(0===r)return-((t+n)/e);var a=Math.pow(1+r,e);return 1===o?-((n*r/(a-1)+t*r/(1-1/a))/(1+r)):-(n*r/(a-1)+t*r/(1-1/a))}function POWER(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return ISNUMBER(n)&&ISNUMBER(o)?Math.pow(n,o):error$2.value}function REPLACE(r,e,t,n){return ISERROR(e)||ISERROR(t)||"string"!=typeof r||"string"!=typeof n?error$2.value:r.substr(0,e-1)+n+r.substr(e-1+t)}function RIGHT(r,e){return ISBLANK(r)?"":N(+e)?r.substring(r.length-e):r}function ROUND(r,e){return+r.toFixed(e)}function ROUNDUP(r,e){var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9],n=t[e];return r>0?Math.ceil(r*n)/n:Math.floor(r*n)/n}function SEARCH(r,e,t){if(!e)return null;t="undefined"==typeof t?1:t;var n=r.replace(/([^~])\?/g,"$1.").replace(/([^~])\*/g,"$1.*").replace(/([~])\?/g,"\\?").replace(/([~])\*/g,"\\*");return t=new RegExp(n,"i").exec(e),t?t.index+1:error$2.value}function SIN(r){return ISNUMBER(r)?Math.sin(r):error$2.value}function SORT(r){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;e>n;n++)t[n-1]=arguments[n];var o=function(){return function(r,e){for(var n=0,o=0;o<t.length;o+2){var a="string"==typeof t[o]?t[o]:t[o]-1,u=t[o+1];return r[a]<e[a]?u?-1:1:u?1:-1}return n}};return ISREF(r)||Array.isArray(r)?r.sort(o()):error$2.na}function SPLIT(r,e){return r.split(e)}function SUBSTITUTE(r,e,t,n){if(!(r&&e&&t))return r;if(void 0===n)return r.replace(new RegExp(e,"g"),t);for(var o=0,a=0;r.indexOf(e,o)>0;)if(o=r.indexOf(e,o+1),a++,a===n)return r.substring(0,o)+t+r.substring(o+e.length)}function SUBTRACT(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return ISNUMBER(n)&&ISNUMBER(o)?n-o:error$2.value}function TAN(r){return ISNUMBER(r)?Math.tan(r):error$2.value}function TAU(){return τ}function TEXT(r,e,t){return FormatNumber.formatNumberWithFormat(r,e,t)}function TRIM(r){return"string"!=typeof r?error$2.value:r.trim()}function UPPER(r){return r.toUpperCase()}function VLOOKUP(r){var e=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],t=arguments.length<=2||void 0===arguments[2]?1:arguments[2],n=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];if(ISERROR(r)||ISBLANK(r))return r;for(var o=0;o<e.length;o++){var a=e[o];if(t>a.length)return error$2.ref;if(n&&a[0]===r||a[0]==r||"string"==typeof a[0]&&-1!=a[0].toLowerCase().indexOf(r.toLowerCase()))return t<a.length+1?a[t-1]:a[0]}return error$2.na}function XOR(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return!!(1&FLATTEN(e).reduce(function(r,e){return e?r+1:r},0))}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol?"symbol":typeof r};FFError.prototype=Error.prototype,FFError.prototype.toString=function(){return this.message};var nil=new FFError("#NULL!"),div0=new FFError("#DIV/0!"),value=new FFError("#VALUE!"),ref=new FFError("#REF!"),name=new FFError("#NAME?"),num=new FFError("#NUM!"),na=new FFError("#N/A!"),error$1=new FFError("#ERROR!"),data=new FFError("#GETTING_DATA!"),missing=new FFError("#MISSING!"),unknown=new FFError("#UNKNOWN!"),error$2={nil:nil,div0:div0,value:value,ref:ref,name:name,num:num,na:na,error:error$1,data:data,missing:missing,unknown:unknown},d1900=new Date(1900,0,1),JulianOffset=2415019,SecondsInHour=3600,SecondsInDay=86400,MilliSecondsInDay=864e5,DayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],DayNames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],MonthNames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],AM="AM",AM1="A",PM="PM",PM1="P",τ=6.28318530717958,MaxCols=16384,SeparatorChar=",",DecimalChar=".",DefaultCurrency="$",AllowedColors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"},CONTAINS=IN,EXACT=function(r,e){return r===e},FormatNumber={};FormatNumber.format_definitions={},FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12},FormatNumber.formatNumberWithFormat=function(r,e,t){var n,o,a,u,s,i,f,c,p,E,l,m,I,d,N,h,A,R,S,g,T,O,M,F,x,D,L,y,v,C,U,b,$,P,B,w,Y,j,X,_,G=FormatNumber,K="";if(r-=0,_=r,!isFinite(_))return"NaN";var W=0>_?1:0;W&&(_=-_);var V=0==_?1:0;if(t=t||DefaultCurrency,FormatNumber.parse_format_string(G.format_definitions,e),R=G.format_definitions[e],!R)throw"Format not parsed error.";if(S=R.sectioninfo.length-1,R.hascomparison)for(S=0,g=0,M=0;;M++){if(n=R.operators[M],o=R.operands[M],!n){g&&(e="General",G.parse_format_string(G.format_definitions,e),R=G.format_definitions[e],S=0);break}if(n!=G.commands.section){if(n==G.commands.comparison){if(D=o.indexOf(":"),T=o.substring(0,D),O=o.substring(D+1)-0,"<"==T&&O>r||"<="==T&&O>=r||"="==T&&r==O||"<>"==T&&r!=O||">="==T&&r>=O||">"==T&&r>O)break;g=1}}else{if(!g)break;g=0,S++}}else S>0&&(1==S?W?(W=0,S=1):S=0:2==S&&(W?(W=0,S=1):S=V?2:0));if(x=R.sectioninfo[S],x.commas>0)for(D=0;D<x.commas;D++)_/=1e3;if(x.percent>0)for(D=0;D<x.percent;D++)_*=100;for(L=1,D=0;D<x.fractiondigits;D++)L*=10;if(y=Math.floor(_*L+.5),y/=L,"number"!=typeof y)return"NaN";if(!isFinite(y))return"NaN";if(v=y+"",0==y&&(x.fractiondigits||x.integerdigits)&&(W=0),v.indexOf("e")>=0)return r+"";if(C=v.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),!C)return"NaN";if(U=C[1],U&&"0"!=U||(U=""),b=C[2],b||(b=""),x.hasdate){if(0>r)return"??-???-?? ??:??:??";for(i=(r-Math.floor(r))*SecondsInDay,f=r*SecondsInDay,c=Math.floor(i/SecondsInHour),l=Math.floor(f/SecondsInHour),i-=c*SecondsInHour,p=Math.floor(i/60),m=Math.floor(f/60),E=i-60*p,L=1,D=0;D<x.fractiondigits;D++)L*=10;for(E=Math.floor(E*L+.5),E/=L,I=Math.floor(f*L+.5),I/=L,E>=60&&(E=0,p++,m++,p>=60&&(p=0,c++,l++,c>=24&&(c=0,r++))),b=E-Math.floor(E)+"",b=b.substring(2),N=PARSEDATE(r),N={year:N.getFullYear(),month:N.getMonth()+1,day:N.getDate()},h=0,A=x.sectionstart;(n=R.operators[A],o=R.operands[A],n)&&n!=G.commands.section;A++)n==G.commands.date?("am/pm"!=o.toLowerCase()&&"a/p"!=o.toLowerCase()||d||(c>=12?(c-=12,d="a/p"==o.toLowerCase()?PM1:PM):d="a/p"==o.toLowerCase()?AM1:AM,o.indexOf(d)<0&&(d=d.toLowerCase())),!h||"m"!=o&&"mm"!=o||(R.operands[A]+="in"),h="h"==o.charAt(0)?1:0):n!=G.commands.copy&&(h=0);for(h=0,--A;(n=R.operators[A],o=R.operands[A],n)&&n!=G.commands.section;A--)n==G.commands.date?(!h||"m"!=o&&"mm"!=o||(R.operands[A]+="in"),h="ss"==o?1:0):n!=G.commands.copy&&(h=0)}for($=0,P=0,B=0,w="",Y="",j=SeparatorChar,j.indexOf(" ")>=0&&(j=j.replace(/ /g," ")),X=DecimalChar,X.indexOf(" ")>=0&&(X=X.replace(/ /g," ")),F=x.sectionstart;n=R.operators[F];)if(o=R.operands[F++],n==G.commands.copy)K+=o;else if(n==G.commands.color)w=o;else if(n==G.commands.style)Y=o;else if(n==G.commands.integer_placeholder){if(W&&(K+="-",W=0),$++,1==$&&U.length>x.integerdigits)for(;P<U.length-x.integerdigits;P++)K+=U.charAt(P),x.thousandssep&&(a=U.length-P-1,a>2&&a%3==0&&(K+=j));U.length<x.integerdigits&&$<=x.integerdigits-U.length?"0"!=o&&"?"!=o||(K+="0"==o?"0":" ",x.thousandssep&&(a=x.integerdigits-$,a>2&&a%3==0&&(K+=j))):(K+=U.charAt(P),x.thousandssep&&(a=U.length-P-1,a>2&&a%3==0&&(K+=j)),P++)}else if(n==G.commands.fraction_placeholder)B>=b.length?"0"!=o&&"?"!=o||(K+="0"==o?"0":" "):K+=b.charAt(B),B++;else if(n==G.commands.decimal)W&&(K+="-",W=0),K+=X;else if(n==G.commands.currency)W&&(K+="-",W=0),K+=o;else if(n==G.commands.general){if(0!=_){var H=Math.floor(Math.LOG10E*Math.log(_));if(H=Math.pow(10,13-H),_=Math.floor(H*_+.5)/H,!isFinite(_))return"NaN"}if(W&&(K+="-"),v=_+"",v.indexOf("e")>=0){K+=v;continue}if(C=v.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),U=C[1],U&&"0"!=U||(U=""),b=C[2],b||(b=""),P=0,B=0,U.length)for(;P<U.length;P++)K+=U.charAt(P),x.thousandssep&&(a=U.length-P-1,a>2&&a%3==0&&(K+=j));else K+="0";if(b.length)for(K+=X;B<b.length;B++)K+=b.charAt(B)}else if(n==G.commands.date)s=o.toLowerCase(),"y"==s||"yy"==s?K+=(N.year+"").substring(2):"yyyy"==s?K+=N.year+"":"d"==s?K+=N.day+"":"dd"==s?(u=1e3+N.day,K+=(u+"").substr(2)):"ddd"==s?(u=Math.floor(r+6)%7,K+=DayNames3[u]):"dddd"==s?(u=Math.floor(r+6)%7,K+=DayNames[u]):"m"==s?K+=N.month+"":"mm"==s?(u=1e3+N.month,K+=(u+"").substr(2)):"mmm"==s?K+=MonthNames3[N.month-1]:"mmmm"==s?K+=MonthNames[N.month-1]:"mmmmm"==s?K+=MonthNames[N.month-1].charAt(0):"h"==s?K+=c+"":"h]"==s?K+=l+"":"mmin"==s?(u=1e3+p+"",K+=u.substr(2)):"mm]"==s?100>m?(u=1e3+m+"",K+=u.substr(2)):K+=m+"":"min"==s?K+=p+"":"m]"==s?K+=m+"":"hh"==s?(u=1e3+c+"",K+=u.substr(2)):"s"==s?(u=Math.floor(E),K+=u+""):"ss"==s?(u=1e3+Math.floor(E)+"",K+=u.substr(2)):"am/pm"==s||"a/p"==s?K+=d:"ss]"==s&&(100>I?(u=1e3+Math.floor(I)+"",K+=u.substr(2)):(u=Math.floor(I),K+=u+""));else{if(n==G.commands.section)break;if(n==G.commands.comparison)continue;K+="!! Parse error.!!"}return w&&(K='<span style="color:'+w+';">'+K+"</span>"),Y&&(K='<span style="'+Y+';">'+K+"</span>"),K},FormatNumber.parse_format_string=function(r,e){var t,n,o,a,u,s,i,f,c,p,E,l,m,I,d,N,h,A,R=FormatNumber,S=1;if(!r[e]){for(t={operators:[],operands:[],sectioninfo:[{}]},r[e]=t,n=0,o=t.sectioninfo[n],o.sectionstart=0,o.integerdigits=0,o.fractiondigits=0,o.commas=0,o.percent=0,h=0;h<e.length;h++)if(A=e.charAt(h),f){if('"'==A){f=0,t.operators.push(R.commands.copy),t.operands.push(c);continue}c+=A}else if(p){if("]"==A){if(p=0,l=FormatNumber.parse_format_bracket(E),l.operator==R.commands.separator){o.thousandssep=1;continue}l.operator==R.commands.date&&(o.hasdate=1),l.operator==R.commands.comparison&&(t.hascomparison=1),t.operators.push(l.operator),t.operands.push(l.operand);continue}E+=A}else if(u)t.operators.push(R.commands.copy),t.operands.push(A),u=!1;else if(s)t.operators.push(R.commands.copy),t.operands.push(A+A+A+A+A),s=!1;else if(i)t.operators.push(R.commands.copy),t.operands.push(" "),i=!1;else{if(m){if("general".charAt(m)==A.toLowerCase()){m++,7==m&&(t.operators.push(R.commands.general),t.operands.push(A),m=0);continue}m=0}if(N){if(N.charAt(0)==A){N+=A;continue}t.operators.push(R.commands.date),t.operands.push(N),o.hasdate=1,N=""}I?(I+=A,d=I.toLowerCase(),d!="am/pm".substring(0,d.length)&&d!="a/p".substring(0,d.length)?ampstr="":"am/pm"!=d&&"a/p"!=d||(t.operators.push(R.commands.date),t.operands.push(I),I="")):"#"==A||"0"==A||"?"==A?S?(o.integerdigits++,o.commas&&(o.thousandssep=1,o.commas=0),a=1,t.operators.push(R.commands.integer_placeholder),t.operands.push(A)):(o.fractiondigits++,t.operators.push(R.commands.fraction_placeholder),t.operands.push(A)):"."==A?(a=0,t.operators.push(R.commands.decimal),t.operands.push(A),S=0):"$"===A?(a=0,t.operators.push(R.commands.currency),t.operands.push(A)):","==A?a?o.commas++:(t.operators.push(R.commands.copy),t.operands.push(A)):"%"==A?(a=0,o.percent++,t.operators.push(R.commands.copy),t.operands.push(A)):'"'==A?(a=0,f=1,c=""):"["==A?(a=0,p=1,E=""):"\\"==A?(u=1,a=0):"*"==A?(s=1,a=0):"_"==A?(i=1,a=0):";"==A?(n++,t.sectioninfo[n]={},o=t.sectioninfo[n],o.sectionstart=1+t.operators.length,o.integerdigits=0,o.fractiondigits=0,o.commas=0,o.percent=0,S=1,a=0,t.operators.push(R.commands.section),t.operands.push(A)):"g"==A.toLowerCase()?(m=1,a=0):"a"==A.toLowerCase()?(I=A,a=0):"dmyhHs".indexOf(A)>=0?N=A:(a=0,t.operators.push(R.commands.copy),t.operands.push(A))}N&&(t.operators.push(R.commands.date),t.operands.push(N),o.hasdate=1)}},FormatNumber.parse_format_bracket=function(r){var e,t=FormatNumber,n={};return"$"==r.charAt(0)?(n.operator=t.commands.currency,e=r.match(/^\$(.+?)(\-.+?){0,1}$/),e?n.operand=e[1]||DefaultCurrency||"$":n.operand=r.substring(1)||DefaultCurrency||"$"):"?$"==r?(n.operator=t.commands.currency,n.operand="[?$]"):AllowedColors[r.toUpperCase()]?(n.operator=t.commands.color,n.operand=AllowedColors[r.toUpperCase()]):(e=r.match(/^style=([^']*)$/))?(n.operator=t.commands.style,n.operand=e[1]):","==r?(n.operator=t.commands.separator,n.operand=r):AllowedDates[r.toUpperCase()]?(n.operator=t.commands.date,n.operand=AllowedDates[r.toUpperCase()]):(e=r.match(/^[<>=]/))?(e=r.match(/^([<>=]+)(.+)$/),n.operator=t.commands.comparison,n.operand=e[1]+":"+e[2]):(n.operator=t.commands.copy,n.operand="["+r+"]"),n},exports.ABS=ABS,exports.ACOS=ACOS,exports.ADD=ADD,exports.AND=AND,exports.AVERAGE=AVERAGE,exports.BIN2DEC=BIN2DEC,exports.CELLINDEX=CELLINDEX,exports.CHANGED=CHANGED,exports.CHOOSE=CHOOSE,exports.CLEAN=CLEAN,exports.CODE=CODE,exports.COLUMN=COLUMN,exports.COLUMNLETTER=COLUMNLETTER,exports.COLUMNNUMBER=COLUMNNUMBER,exports.CONCATENATE=CONCATENATE,exports.COND=COND,exports.CONTAINS=CONTAINS,exports.COS=COS,exports.DATE=DATE,exports.DATEVALUE=DATEVALUE,exports.DATEDIF=DATEDIF,exports.DAYS360=DAYS360,exports.DEC2BIN=DEC2BIN,exports.DIFF=DIFF,exports.DIVIDE=DIVIDE,exports.EQ=EQ,exports.EXACT=EXACT,exports.FILTER=FILTER,exports.FIND=FIND,exports.FLATTEN=FLATTEN,exports.GT=GT,exports.GTE=GTE,exports.GUID=GUID,exports.HLOOKUP=HLOOKUP,exports.IF=IF,exports.IFBLANK=IFBLANK,exports.IFEMPTY=IFEMPTY,exports.IFERROR=IFERROR,exports.IFNA=IFNA,exports.IN=IN,exports.INDEX2COL=INDEX2COL,exports.INDEX2ROW=INDEX2ROW,exports.INDIRECT=INDIRECT,exports.ISARRAY=ISARRAY,exports.ISBLANK=ISBLANK,exports.ISDATE=ISDATE,exports.ISEMAIL=ISEMAIL,exports.ISEMPTY=ISEMPTY,exports.ISERROR=ISERROR,exports.ISEVEN=ISEVEN,exports.ISFUNCTION=ISFUNCTION,exports.ISNA=ISNA,exports.ISNUMBER=ISNUMBER,exports.ISODD=ISODD,exports.ISREF=ISREF,exports.ISTEXT=ISTEXT,exports.ISURL=ISURL,exports.LEN=LEN,exports.LOOKUP=LOOKUP,exports.LOWER=LOWER,exports.LT=LT,exports.LTE=LTE,exports.MIN=MIN,exports.MAX=MAX,exports.MULTIPLY=MULTIPLY,exports.N=N,exports.NUMBERVALUE=NUMBERVALUE,exports.NE=NE,exports.NOT=NOT,exports.OCT2DEC=OCT2DEC,exports.OR=OR,exports.PARSEBOOL=PARSEBOOL,exports.PARSEDATE=PARSEDATE,exports.PI=PI,exports.PMT=PMT,exports.POWER=POWER,exports.REF=REF,exports.REPLACE=REPLACE,exports.REPT=REPT,exports.RIGHT=RIGHT,exports.ROUND=ROUND,exports.ROUNDUP=ROUNDUP,exports.SEARCH=SEARCH,exports.SELECT=SELECT,exports.SERIAL=SERIAL,exports.SIN=SIN,exports.SORT=SORT,exports.SPLIT=SPLIT,exports.SUBSTITUTE=SUBSTITUTE,exports.SUBTRACT=SUBTRACT,exports.SUM=SUM,exports.TAN=TAN,exports.TAU=TAU,exports.TEXT=TEXT,exports.TRIM=TRIM,exports.UNIQUE=UNIQUE,exports.UPPER=UPPER,exports.VLOOKUP=VLOOKUP,exports.XOR=XOR;

},{}],6:[function(require,module,exports){
(function (process){
function normalizeArray(r,t){for(var e=0,n=r.length-1;n>=0;n--){var s=r[n];"."===s?r.splice(n,1):".."===s?(r.splice(n,1),e++):e&&(r.splice(n,1),e--)}if(t)for(;e--;e)r.unshift("..");return r}function filter(r,t){if(r.filter)return r.filter(t);for(var e=[],n=0;n<r.length;n++)t(r[n],n,r)&&e.push(r[n]);return e}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(r){return splitPathRe.exec(r).slice(1)};exports.resolve=function(){for(var r="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var n=e>=0?arguments[e]:process.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(r=n+"/"+r,t="/"===n.charAt(0))}return r=normalizeArray(filter(r.split("/"),function(r){return!!r}),!t).join("/"),(t?"/":"")+r||"."},exports.normalize=function(r){var t=exports.isAbsolute(r),e="/"===substr(r,-1);return r=normalizeArray(filter(r.split("/"),function(r){return!!r}),!t).join("/"),r||t||(r="."),r&&e&&(r+="/"),(t?"/":"")+r},exports.isAbsolute=function(r){return"/"===r.charAt(0)},exports.join=function(){var r=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(r,function(r,t){if("string"!=typeof r)throw new TypeError("Arguments to path.join must be strings");return r}).join("/"))},exports.relative=function(r,t){function e(r){for(var t=0;t<r.length&&""===r[t];t++);for(var e=r.length-1;e>=0&&""===r[e];e--);return t>e?[]:r.slice(t,e-t+1)}r=exports.resolve(r).substr(1),t=exports.resolve(t).substr(1);for(var n=e(r.split("/")),s=e(t.split("/")),i=Math.min(n.length,s.length),o=i,u=0;i>u;u++)if(n[u]!==s[u]){o=u;break}for(var l=[],u=o;u<n.length;u++)l.push("..");return l=l.concat(s.slice(o)),l.join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(r){var t=splitPath(r),e=t[0],n=t[1];return e||n?(n&&(n=n.substr(0,n.length-1)),e+n):"."},exports.basename=function(r,t){var e=splitPath(r)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e},exports.extname=function(r){return splitPath(r)[3]};var substr="b"==="ab".substr(-1)?function(r,t,e){return r.substr(t,e)}:function(r,t,e){return 0>t&&(t=r.length+t),r.substr(t,e)};

}).call(this,require('_process'))
},{"_process":7}],7:[function(require,module,exports){
function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=setTimeout(cleanUpNextTick);draining=!0;for(var n=queue.length;n;){for(currentQueue=queue,queue=[];++queueIndex<n;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,n=queue.length}currentQueue=null,draining=!1,clearTimeout(e)}}function Item(e,n){this.fun=e,this.array=n}function noop(){}var process=module.exports={},queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];queue.push(new Item(e,n)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}]},{},[1]);
